
var canvas,stage,exportRoot;var LANG="en";function forceES(){LANG="es";init()}function init(){storytext=(LANG=="en")?storytext_en:storytext_es;$(window).resize(resizeCanvasLocal);resizeCanvasLocal();window.addEventListener("orientationchange",function(){setTimeout(resizeCanvasLocal,100)},false);createjs.MotionGuidePlugin.install();canvas=document.getElementById("canvas");images=images||{};sounds=[];var a=new createjs.LoadQueue(false);a.installPlugin(createjs.Sound);createjs.Sound.alternateExtensions=["ogg"];a.addEventListener("fileload",handleFileLoad);a.addEventListener("complete",loadSounds);a.loadManifest(lib.properties.manifest)}function handleFileLoad(a){if(a.item.type=="image"){images[a.item.id]=a.result}}function loadSounds(){sndch=createjs.Sound;sndch_fx=createjs.Sound;sndQ=new createjs.LoadQueue(false);sndQ.addEventListener("complete",sndQ_handleComplete);sndQ.addEventListener("fileload",sndQ_handleFileLoad);createjs.Sound.registerSound("snd_"+LANG+"/screen1.mp3","screen1");createjs.Sound.registerSound("snd_"+LANG+"/screen2.mp3","screen2");createjs.Sound.registerSound("snd_"+LANG+"/screen3.mp3","screen3");createjs.Sound.registerSound("snd_"+LANG+"/screen4.mp3","screen4");createjs.Sound.registerSound("snd_"+LANG+"/screen5.mp3","screen5");createjs.Sound.registerSound("snd_"+LANG+"/screen6.mp3","screen6");createjs.Sound.registerSound("snd_"+LANG+"/screen8.mp3","screen8");createjs.Sound.registerSound("snd_"+LANG+"/screen9.mp3","screen9");createjs.Sound.registerSound("snd_"+LANG+"/screen10.mp3","screen10");createjs.Sound.registerSound("snd_"+LANG+"/screen11.mp3","screen11");createjs.Sound.registerSound("snd_"+LANG+"/screen12_better.mp3","screen12_better");createjs.Sound.registerSound("snd_"+LANG+"/screen12_call.mp3","screen12_call");createjs.Sound.registerSound("snd_"+LANG+"/screen12_checkketones.mp3","screen12_checkketones");createjs.Sound.registerSound("snd_"+LANG+"/screen12_waterinsulin.mp3","screen12_waterinsulin");createjs.Sound.registerSound("snd_"+LANG+"/screen13.mp3","screen13");createjs.Sound.registerSound("snd_"+LANG+"/screen14.mp3","screen14");createjs.Sound.registerSound("snd_"+LANG+"/screen15.mp3","screen15");createjs.Sound.registerSound("snd_sfx/sfx_btnclick.mp3","sfx_btnclick");createjs.Sound.registerSound("snd_sfx/sfx_pancspitout.mp3","sfx_pancspitout");createjs.Sound.registerSound("snd_sfx/sfx_cellshrink.mp3","sfx_cellshrink");createjs.Sound.registerSound("snd_sfx/sfx_cellmunching.mp3","sfx_cellmunching");createjs.Sound.registerSound("snd_sfx/bubblepop.mp3","bubblepop");createjs.Sound.registerSound("snd_sfx/calldoctor.mp3","calldoctor");createjs.Sound.registerSound("snd_sfx/click6.mp3","click6");createjs.Sound.registerSound("snd_sfx/drinkwater.mp3","drinkwater");createjs.Sound.registerSound("snd_sfx/g_appear.mp3","g_appear");createjs.Sound.registerSound("snd_sfx/k_appear.mp3","k_appear");createjs.Sound.registerSound("snd_sfx/pancreas1.mp3","pancreas1");createjs.Sound.registerSound("snd_sfx/pancreas_unhealthy.mp3","pancreas_unhealthy");createjs.Sound.registerSound("snd_sfx/screen_opening.mp3","screen_opening");createjs.Sound.registerSound("snd_sfx/squish2.mp3","squish2");createjs.Sound.registerSound("snd_sfx/swoosh2.mp3","swoosh2");createjs.Sound.registerSound("snd_sfx/swoosh3.mp3","swoosh3");createjs.Sound.registerSound("snd_sfx/swoosh4.mp3","swoosh4");createjs.Sound.registerSound("snd_sfx/urinate.mp3","urinate");createjs.Sound.registerSound("snd_sfx/vomit2.mp3","vomit2");createjs.Sound.registerSound("snd_sfx/snd_weakness.mp3","snd_weakness");createjs.Sound.registerSound("snd_sfx/snd_dehydration.mp3","snd_dehydration");createjs.Sound.registerSound("snd_sfx/snd_heavybreathing.mp3","snd_heavybreathing");sndQ.load()}function sndQ_handleFileLoad(a){sounds[a.item.id]=a.result}function sndQ_handleComplete(a){loadingAllDone()}function loadingAllDone(){exportRoot=new lib.ketones_www();stage=new createjs.Stage(canvas);stage.enableMouseOver(20);stage.mouseMoveOutside=true;isTouch=createjs.Touch.isSupported();createjs.Touch.enable(stage,true,false);stage.addChild(exportRoot);stage.update();createjs.Ticker.setFPS(lib.properties.fps);createjs.Ticker.addEventListener("tick",stage)}function playSound(b,a){sndch=createjs.Sound.play(b)}function stopSound(){sndch.stop()}function playSfx(a){sndch_fx=createjs.Sound.play(a,{volume:0.4})}function stopSfx(){sndch_fx.stop()}function resizeCanvasLocal(){var a=$("#canvas");var b=($(window).width()-a.width())/2;$("#storytxt").css({width:(a.width()*0.75)+"px",top:(a.height()*0.825)+"px",left:(a.width()*0.125)+b+"px"});change_storytext()}function addHandHover(a){a.addEventListener("mouseover",cursorPointer);a.addEventListener("rollover",cursorPointer);a.addEventListener("mouseout",cursorDefault);a.addEventListener("rollout",cursorDefault)}function removeHandHover(a){a.removeEventListener("mouseover",cursorPointer);a.removeEventListener("rollover",cursorPointer);a.removeEventListener("mouseout",cursorDefault);a.removeEventListener("rollout",cursorDefault)}function cursorPointer(a){document.body.style.cursor="pointer"}function cursorDefault(a){document.body.style.cursor="default"}function begin_pulseObj(a){a.startSX=a.scaleX;a.startSY=a.scaleY;createjs.Tween.get(a,{loop:true}).to({scaleX:a.scaleX*1.1,scaleY:a.scaleY*1.1},250,createjs.Ease.none).wait(250).to({scaleX:a.scaleX,scaleY:a.scaleY},250,createjs.Ease.none).wait(250)}function end_pulseObj(a){createjs.Tween.removeTweens(a);a.scaleX=a.startSX||1;a.scaleY=a.startSY||1};