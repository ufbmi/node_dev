var canvas,stage,exportRoot;var LANG="en";var urlParams={};function forceES(){LANG="es";init()}function init(){createjs.Ticker.setFPS(30);createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED;storytext=(LANG=="en")?storytext_en:storytext_es;$(window).resize(resizeCanvasLocal);resizeCanvasLocal();window.addEventListener("orientationchange",function(){setTimeout(resizeCanvasLocal,100)},false);createjs.MotionGuidePlugin.install();canvas=document.getElementById("canvas");images=images||{};sounds=[];var a=new createjs.LoadQueue(false);a.installPlugin(createjs.Sound);createjs.Sound.alternateExtensions=["ogg"];a.addEventListener("fileload",handleFileLoad);a.addEventListener("complete",loadSounds);a.loadManifest(lib.properties.manifest)}function handleFileLoad(a){if(a.item.type=="image"){images[a.item.id]=a.result}}function loadSounds(){sndch=createjs.Sound;sndch_fx=createjs.Sound;sndQ=new createjs.LoadQueue(false);sndQ.addEventListener("complete",sndQ_handleComplete);sndQ.addEventListener("fileload",sndQ_handleFileLoad);createjs.Sound.registerSound("snd_"+LANG+"/screen1.mp3","screen1");createjs.Sound.registerSound("snd_"+LANG+"/screen2.mp3","screen2");createjs.Sound.registerSound("snd_"+LANG+"/screen3.mp3","screen3");createjs.Sound.registerSound("snd_"+LANG+"/screen4.mp3","screen4");createjs.Sound.registerSound("snd_"+LANG+"/screen5.mp3","screen5");createjs.Sound.registerSound("snd_"+LANG+"/screen6.mp3","screen6");createjs.Sound.registerSound("snd_"+LANG+"/screen7.mp3","screen7");createjs.Sound.registerSound("snd_"+LANG+"/screen75.mp3","screen75");createjs.Sound.registerSound("snd_"+LANG+"/screen8.mp3","screen8");createjs.Sound.registerSound("snd_"+LANG+"/screen9.mp3","screen9");createjs.Sound.registerSound("snd_"+LANG+"/screen10.mp3","screen10");createjs.Sound.registerSound("snd_"+LANG+"/screen11.mp3","screen11");createjs.Sound.registerSound("snd_"+LANG+"/screen12.mp3","screen12");createjs.Sound.registerSound("snd_"+LANG+"/screen13.mp3","screen13");createjs.Sound.registerSound("snd_"+LANG+"/screen14.mp3","screen14");createjs.Sound.registerSound("snd_"+LANG+"/screen14a.mp3","screen14a");createjs.Sound.registerSound("snd_"+LANG+"/screen15.mp3","screen15");createjs.Sound.registerSound("snd_"+LANG+"/screen15a16a.mp3","screen15a16a");createjs.Sound.registerSound("snd_"+LANG+"/screen15b.mp3","screen15b");createjs.Sound.registerSound("snd_"+LANG+"/screen16.mp3","screen16");createjs.Sound.registerSound("snd_"+LANG+"/screen16b.mp3","screen16b");createjs.Sound.registerSound("snd_"+LANG+"/screen17.mp3","screen17");createjs.Sound.registerSound("snd_sfx/snd_eating.mp3","snd_eating");createjs.Sound.registerSound("snd_sfx/snd_pancreastries.mp3","snd_pancreastries");createjs.Sound.registerSound("snd_sfx/snd_glucoseappear.mp3","snd_glucoseappear");createjs.Sound.registerSound("snd_sfx/snd_gimeet.mp3","snd_gimeet");createjs.Sound.registerSound("snd_sfx/snd_insulininjection.mp3","snd_insulininjection");createjs.Sound.registerSound("snd_sfx/snd_swoosh.mp3","snd_swoosh");createjs.Sound.registerSound("snd_sfx/snd_lookinside.mp3","snd_lookinside");createjs.Sound.registerSound("snd_sfx/snd_insulinappear.mp3","snd_insulinappear");createjs.Sound.registerSound("snd_sfx/snd_buttonclick.mp3","sfx_btnclick");createjs.Sound.registerSound("snd_sfx/click6.mp3","click6");createjs.Sound.registerSound("snd_sfx/dn_med.mp3","dn_med");createjs.Sound.registerSound("snd_sfx/dn_short.mp3","dn_short");createjs.Sound.registerSound("snd_sfx/dn_xlong.mp3","dn_xlong");createjs.Sound.registerSound("snd_sfx/up_long.mp3","up_long");createjs.Sound.registerSound("snd_sfx/up_xlong.mp3","up_xlong");sndQ.load()}function sndQ_handleFileLoad(a){sounds[a.item.id]=a.result}function sndQ_handleComplete(a){loadingAllDone()}function loadingAllDone(){exportRoot=new lib.basalBolus();stage=new createjs.Stage(canvas);stage.enableMouseOver(20);stage.mouseMoveOutside=true;isTouch=createjs.Touch.isSupported();createjs.Touch.enable(stage,true,false);stage.addChild(exportRoot);stage.update();createjs.Ticker.setFPS(lib.properties.fps);createjs.Ticker.addEventListener("tick",stage)}function playSound(b,a){sndch=createjs.Sound.play(b)}function playSoundCall(b,a){sndch=createjs.Sound.play(b);sndch.addEventListener("complete",a)}function stopSound(){sndch.stop()}function playSfx(a){sndch_fx=createjs.Sound.play(a,{volume:0.4})}function playSfxVol(b,a){sndch_fx=createjs.Sound.play(b,{volume:a})}function stopSfx(){sndch_fx.stop()}function resizeCanvasLocal(){var a=$("#canvas");var b=($(window).width()-a.width())/2;$("#storytxt").css({width:(a.width()*0.75)+"px",top:(a.height()*0.825)+"px",left:(a.width()*0.125)+b+"px"});change_storytext()}function addHandHover(a){a.addEventListener("mouseover",cursorPointer);a.addEventListener("rollover",cursorPointer);a.addEventListener("mouseout",cursorDefault);a.addEventListener("rollout",cursorDefault)}function removeHandHover(a){a.removeEventListener("mouseover",cursorPointer);a.removeEventListener("rollover",cursorPointer);a.removeEventListener("mouseout",cursorDefault);a.removeEventListener("rollout",cursorDefault)}function cursorPointer(a){document.body.style.cursor="pointer"}function cursorDefault(a){document.body.style.cursor="default"}function begin_pulseObj(a){a.startSX=a.scaleX;a.startSY=a.scaleY;createjs.Tween.get(a,{loop:true}).to({scaleX:a.scaleX*1.1,scaleY:a.scaleY*1.1},250,createjs.Ease.none).wait(250).to({scaleX:a.startSX,scaleY:a.startSY},250,createjs.Ease.none).wait(250)}function end_pulseObj(a){createjs.Tween.removeTweens(a);a.scaleX=a.startSX||1;a.scaleY=a.startSY||1}function begin_pulseAlt(a){a.startSX=a.scaleX;a.startSY=a.scaleY;createjs.Tween.get(a,{loop:true}).to({scaleX:a.scaleX*1.06,scaleY:a.scaleY*1.06},250,createjs.Ease.none).wait(250).to({scaleX:a.startSX,scaleY:a.startSY},250,createjs.Ease.none).wait(250)};